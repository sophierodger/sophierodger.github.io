{
  "hash": "6d90fddefabd6d744d7e7e734e242186",
  "result": {
    "markdown": "---\ntitle: \"Beer Markets\"\nauthor: \"Sophia Rodger\"\ndate: \"2023-10-30\"\nimage: \"beer.png\"\n\nexecute:\n  message: false\n  warning: false\n  \ntoc: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(skimr)\n\nbeer_mkts <- read_csv('https://bcdanl.github.io/data/beer_markets.csv')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_markets <- beer_mkts %>%\n  group_by(brand, market) %>%\n  summarize(total_floz = sum(beer_floz)) %>%\n  arrange(brand, desc(total_floz)) %>%\n  group_by(brand) %>%\n  slice(1:5)\ntop_markets\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 3\n# Groups:   brand [5]\n   brand       market      total_floz\n   <chr>       <chr>            <dbl>\n 1 BUD LIGHT   PHOENIX         271012\n 2 BUD LIGHT   TAMPA           171830\n 3 BUD LIGHT   MIAMI           152990\n 4 BUD LIGHT   ST. LOUIS       140982\n 5 BUD LIGHT   CHARLOTTE       136786\n 6 BUSCH LIGHT RURAL IOWA      184000\n 7 BUSCH LIGHT HOUSTON         154896\n 8 BUSCH LIGHT CHICAGO         118916\n 9 BUSCH LIGHT TAMPA           110680\n10 BUSCH LIGHT MINNEAPOLIS      92992\n# ℹ 15 more rows\n```\n:::\n\n```{.r .cell-code}\n# This code finds the top 5 markets in terms of total beer_floz for each beer brand\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nloyal_consumers <- beer_mkts %>%\n  group_by(hh, brand) %>%\n  summarize(purchased = n()) %>%\n  group_by(brand) %>%\n  mutate(total_hh = n(),\n         fraction = sum(purchased == 1) / total_hh) %>%\n  arrange(desc(fraction))\nloyal_consumers\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13,202 × 5\n# Groups:   brand [5]\n        hh brand       purchased total_hh fraction\n     <dbl> <chr>           <int>    <int>    <dbl>\n 1 2000417 COORS LIGHT         8     3045    0.529\n 2 2000711 COORS LIGHT        13     3045    0.529\n 3 2001521 COORS LIGHT         3     3045    0.529\n 4 2001825 COORS LIGHT         1     3045    0.529\n 5 2001871 COORS LIGHT         1     3045    0.529\n 6 2001947 COORS LIGHT         5     3045    0.529\n 7 2001978 COORS LIGHT         1     3045    0.529\n 8 2002617 COORS LIGHT        24     3045    0.529\n 9 2002856 COORS LIGHT         2     3045    0.529\n10 2003419 COORS LIGHT         2     3045    0.529\n# ℹ 13,192 more rows\n```\n:::\n\n```{.r .cell-code}\n# This code calculates the fraction of households purchasing only each beer brand\n\nlargest_proportion_brand <- loyal_consumers %>%\n  arrange(desc(fraction)) %>%\n  slice(1)\nlargest_proportion_brand\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 5\n# Groups:   brand [5]\n       hh brand         purchased total_hh fraction\n    <dbl> <chr>             <int>    <int>    <dbl>\n1 2000235 BUD LIGHT             1     4657    0.499\n2 2001531 BUSCH LIGHT           1     1110    0.457\n3 2000417 COORS LIGHT           8     3045    0.529\n4 2000946 MILLER LITE           1     3195    0.487\n5 2001715 NATURAL LIGHT         1     1195    0.403\n```\n:::\n\n```{.r .cell-code}\n# This code finds the brand with the largest proportion of loyal consumers\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhousehold_stats <- beer_mkts %>%\n  group_by(hh) %>%\n  summarize(num_transactions = n(),\n            proportion_bud_light = mean(brand == \"Bud Light\"),\n            proportion_busch_light = mean(brand == \"Busch Light\"),\n            proportion_coors_light = mean(brand == \"Coors Light\"),\n            proportion_miller_lite = mean(brand == \"Miller Lite\"),\n            proportion_natural_light = mean(brand == \"Natural Light\"))\nhousehold_stats\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10,408 × 7\n        hh num_transactions proportion_bud_light proportion_busch_light\n     <dbl>            <int>                <dbl>                  <dbl>\n 1 2000235                1                    0                      0\n 2 2000417                8                    0                      0\n 3 2000711               13                    0                      0\n 4 2000946                2                    0                      0\n 5 2001521               11                    0                      0\n 6 2001531                1                    0                      0\n 7 2001581                5                    0                      0\n 8 2001582               13                    0                      0\n 9 2001618                1                    0                      0\n10 2001715                3                    0                      0\n# ℹ 10,398 more rows\n# ℹ 3 more variables: proportion_coors_light <dbl>,\n#   proportion_miller_lite <dbl>, proportion_natural_light <dbl>\n```\n:::\n\n```{.r .cell-code}\n# This code calculates the number of beer transactions and proportion of each \n# beer brand choice for each household\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}