{
  "hash": "027aa889ed90a34612441e38fe89088a",
  "result": {
    "markdown": "---\ntitle: \"NFL in 2022\"\nauthor: \"Sophia Rodger\"\ndate: \"2023-10-30\"\nimage: \"image.png\"\n\nexecute:\n  message: false\n  warning: false\n  \ntoc: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2a\nNFL2022_stuffs <- read_csv('https://bcdanl.github.io/data/NFL2022_stuffs.csv')\n NFL2022_stuffs <- NFL2022_stuffs[complete.cases(NFL2022_stuffs$posteam), ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2b\n filtered_data <- NFL2022_stuffs %>%\n  filter(wp > 0.2 & wp < 0.75, down <= 2, half_seconds_remaining > 120)\n\n summary_pass <- filtered_data %>%\n  group_by(posteam) %>%\n  summarize(mean_pass = mean(pass, na.rm = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2c\nlibrary(ggplot2)\n\n# Reordering posteam based on mean value of pass\n summary_pass$posteam <- factor(summary_pass$posteam, levels =  summary_pass$posteam[order(summary_pass$mean_pass)])\n\n# Plotting\n ggplot(summary_pass, aes(x = mean_pass, y = posteam)) +\n  geom_point() +\n  labs(title = \"Mean Value of Pass for Each posteam\",\n       x = \"Percentage of pass plays\",\n       y = \"Team with possession\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](nflhw_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2d\nNFL2022_epa <- read_csv('https://bcdanl.github.io/data/NFL2022_epa.csv')\n\nNFL2022_stuffs_EPA <- NFL2022_stuffs %>%\n  left_join(NFL2022_epa %>% select(play_id, passer, receiver, epa), by = \"play_id\") %>%\n  filter(!is.na(passer))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2e\nweekly_trend <- NFL2022_stuffs_EPA %>%\n  filter(passer %in% c(\"J.Allen\", \"P.Mahomes\")) %>%\n group_by(week, passer) %>%\n  summarize(mean_epa = mean(epa, na.rm = TRUE))\n\n# Plotting\nggplot(weekly_trend, aes(x = week, y = mean_epa, color = passer)) +\n  geom_line() +\n  labs(title = \"NFL Weekly Trend of Mean EPA\",\n       x = \"Week\",\n       y = \"Mean EPA\") +\n theme_minimal()\n```\n\n::: {.cell-output-display}\n![](nflhw_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2f\nmean_epa_diff <- weekly_trend %>%\n  spread(passer, mean_epa) %>%\n  mutate(diff_J_Allen_P_Mahomes = `J.Allen` - `P.Mahomes`)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q2g\npasser_summary <- NFL2022_stuffs_EPA %>%\n  group_by(posteam, passer) %>%\n  summarize(mean_epa = mean(epa, na.rm = TRUE),\n            n_pass = n()) %>%\n  filter(n_pass >= quantile(n_pass, 0.75))\n\ntop_10_passers <- passer_summary %>%\n  group_by(passer) %>%\n  summarize(mean_epa = mean(mean_epa, na.rm = TRUE)) %>%\n  top_n(10, wt = mean_epa)\n```\n:::\n",
    "supporting": [
      "nflhw_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}